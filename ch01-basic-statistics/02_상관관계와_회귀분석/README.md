<!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->

<!-- code_chunk_output -->
<!-- /code_chunk_output -->

## 01 상관관계

### 상관관계와 인과관계

상관관계는 역이 성립하지만(원인과 결과가 뒤바뀜) 인과관계는 비대칭이다.

- A라서 B가 발생했다(인과) -> B라서 A가 발생했다(거짓)
- A란 경향이면 B란 경향이다(상관) -> B란 경향을 보이면 A란 경향이다(참)

### correlation coefficient(상관계수, r)

보통 두 변수로 이루어진 자료는 다음과 같은 통계량으로 요약된다.
x, y의 $\mu$와 $\sigma$, 상관관계($r$)
$$ -1 \leq r \leq 1 $$

보통 `피어슨 상관계수`를 가장 많이 사용하고 스피어만 상관계수 등을 사용하기도 한다.

피어슨 상관계수는 다음과 같이 계산된다. 공분산을 각각의 표준편차의 곱으로 나눈 간편한 식이 자주 사용된다.

$$
r = \frac{\sum_{i=1}^{n}(x_i-\bar{x})(y_i-\bar{y})}{\sqrt{\sum_{i=1}^{n}(x_i-\bar{x})^2}\cdot{}\sqrt{\sum_{i=1}^{n}(y_i-\bar{y})^2}} \\
  = \frac{\sum_{i=1}^{n}(x_i-\bar{x})(y_i-\bar{y}) / (n-1)}{\sqrt{\sum_{i=1}^{n}(x_i-\bar{x})^2 / (n-1)}\dot{}\sqrt{\sum_{i=1}^{n}(y_i-\bar{y})^2 / (n-1)}} \\
  = \frac{Cov(X, Y)}{SD_x \cdot{} SD_y}
$$

### 상관계수의 의미와 한계

- 상관 계수가 0.8이면 0.4인 관계보다 두 배만큼 강한 관계?
  - 강도가 2배라는 말은 틀렸다. 상관 관계가 0.8이라면 단순히 0.4보다 클 뿐, 강도가 숫자 그대로 표현되는 것은 아니다.
- 변수의 선형 변환(ax+b)은 상관계수를 변화시키지 않는다.
  - 상관계수는 두 변수의 선형 변환에 영향을 받지 않는다. 수학적으로 증명할 수 있으나 지면이 부족하여...
- 상관 계수는 `두 변수간의 scatter plot이 타원형일 경우에 적합하다`. 그렇지 않으면 상관계수의 유용성이 떨어진다.
  - outlier의 존재, 두 변수가 비선형 관계일 경우에는 상관계수가 덜 유용하다.
  - 예를 들어 인간이 느끼는 쾌적함과 온도라는 두 변수는 비선형 관계이다. 단순히 온도가 높거나 낮다고해서 쾌적함이 선형적으로 관계성을 드러내지 않는다.
- 잘못 해석하면 실제의 관계를 과장하게 된다.
  - 지역, 국가 등 집단 단위의 자료의 상관계수는 개개인에게 적용되는 관계를 과장할 수 있다.
- 강한 상관관계를 가진다고해서 그것이 인과관계를 드러내지는 않는다.
  - 발의 크기와 어휘력이란 두 변수 사이의 상관관계는 인과가 아니다. 나이라는 confounding factor를 무시한 것이다.

## 02 simple regression analysis (단순회귀분석)

### regression line(회귀 직선)

y의 x에 대한(x에 대한 y의) 회귀직선은 각각의 x값에 대응하는 y의 평균값을 추정한다.
일반적으로 x, y가 선형적 관계에 놓여있다는 전제 하에, 그들의 평균, 표준편차, 상관계수가 존재한다면 이들을 이용하여 회귀직선을 추정할 수 있다. 왜냐하면 x가 $1 SD_x$가 증가함에 따라 y도 $r SD_y$만큼 증가하는 경향이 있기 때문이다.
이러한 정의에 따라 회귀 직선의 기울기는 $r * \frac{SD_x}{SD_y}$이다. SD_x가 변화할 때마다 r \* SD_y만큼 y가 변화하기 때문이다.

그리고 이 회귀 직선은, 앞서 살펴보았듯, scatter plot을 그려보았을 때 타원형이 아닌 형태라면 무의미해진다.
data의 분포가 타원형이 아니라면, 회귀 직선은 data의 분포를 잘 설명하지 못한다.

뿐만 아니라 기존 자료에 포함되지 않는 경우, 대표적으로 (1) 새로운 개체가 기존 데이터와 성격이 다른 경우 (2) 아웃라이어인 경우에는 회귀 직선을 통한 값 추정이 틀릴 가능성이 높다. 이러한 문제를 extrapolation(외삽)이라고 한다.

### regression effect

평균으로의 회귀.

### 용어의 혼란 주의

- y의 x에 대한 값 = x에 대한 y값 = x 값을 기반으로 y값을 추정하고 싶다 = 기울기는 $r \times \frac{SD_y}{SD_x}$

- x의 y에 대한 값 = y에 대한 x값 = y값을 기반으로 x값을 추정하고 싶다 = 기울기는 $r \times \frac{SD_x}{SD_y}$

## 03 회귀분석의 오차

### residual(잔차), RMSE

실제값과 회귀를 통한 추정치와의 차이를 추정 오차라 한다. 간단히, 실제값과 추정치를 빼면 잔차(residual)가 나온다.
잔차를 기반으로 회귀분석의 전반적 오차를 측정하게 된다.

이 잔차의 제곱합(SSE, sum of squared error)
MSE(mean squared error) = $\frac{SSE}{n - 2}$
RMSE(root mean squared error) = $\sqrt{MSE}$

꼴로 유도하는데 보통 곧장 RMSE를 계산한다. 수식에서 밑변이 자유도인 `n-2`를 사용함에 유의하자.

$$
RMSE = \sqrt{\frac{(x - x_1)^2 + ... + (x - x_n)^2}{n-2}}
$$

RMSE는 표준편차와 같이 해당 직선으로부터 $\pm 1 RMSE$ 떨어진 데이터들이 68%, $\pm 2 RMSE$ 떨어진 데이터들이 95% 존재한다는 것을 의미한다.

### correlation coefficient(r)를 통한 RMSE 추정

x에 관한 y를 회귀 추정할 경우 계산되는 RMSE는 아래와 같이 근사될 수 있다.
RMSE는 정의상 자유도가 -2 이지만 SD를 구할 때는 -1이기 때문에 값이 같지는 않다. 다만 표본의 수가 많으면 그 값에 큰 차이가 없다.

$$
RMSE \approx \sqrt{1 - r^2} \times SD_y
$$

### homoscedasticity, heteroscedasticity(등분산성과 이분산성)

잔차의 분산이 일정한 경우 homoscedasticity, 일정하지 않은 경우 heteroscedasticity라고 한다.

풀어쓰자면, scatter plot으로 데이터를 그린 후에 세로띠를 그려 특정 x에 속한 (x, y) 순서쌍들이 가지는 y가 퍼져 있는 정도(분산, 표준편차)를 확인할 수 있을 것이다. 이 정도가 x에 따라 일관된다면 해당 데이터는 homoscedasticity를 가지고 있다고 할 수 있으며 RMSE의 추정 오차가 어느 곳에서나 적용될 수 있다고 볼 수 있다.

그러나 x에 따라 퍼져있는 정도가 일정하지 않다면 RMSE를 일관되게 적용할 수 없으며 해당 데이터는 heteroscedasticity를 가지고 있다고 할 수 있다.

단순하게 생각하면 scatter plot이 타원형이라면 등분산성을 가정하고 회귀분석을 진행할 수 있다.

## 04 회귀직선

## glossary

- 독립변수(independent variable): x. 설명 변수로 x -> y의 관계를 설명한다.
- 종속변수(dependent variable): y. 피설명변수로 x에 의한 영향을 받는다.
